apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: hypercube
  name: hypercube
spec:
  replicas: 1
  selector:
    matchLabels:
      app: hypercube
  template:
    metadata:
      labels:
        app: hypercube
    spec:
      containers:
      - image: ghcr.io/jhu-idc/hypercube:v0.2.0
        name: hypercube
        readinessProbe:
          tcpSocket:
            port: 8000
          initialDelaySeconds: 10
          periodSeconds: 20
        livenessProbe:
          tcpSocket:
            port: 8000
          initialDelaySeconds: 15
          periodSeconds: 20        
        resources:
          requests:
            memory: 100Mi
          limits:
            memory: 200Mi  
        env:
          - name: HYPERCUBE_JWT_PUBLIC_KEY
            valueFrom:
              secretKeyRef:
                name: drupal-sealed
                key: jwt_public_key
          - name: HYPERCUBE_JWT_ADMIN
            value: islandora
